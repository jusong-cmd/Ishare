(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/info/index"],{"5fa7":function(t,i,a){"use strict";(function(t,n){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var e=s(a("8c5a"));function s(t){return t&&t.__esModule?t:{default:t}}function o(t,i){return c(t)||r(t,i)||l()}function l(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function r(t,i){var a=[],n=!0,e=!1,s=void 0;try{for(var o,l=t[Symbol.iterator]();!(n=(o=l.next()).done);n=!0)if(a.push(o.value),i&&a.length===i)break}catch(r){e=!0,s=r}finally{try{n||null==l["return"]||l["return"]()}finally{if(e)throw s}}return a}function c(t){if(Array.isArray(t))return t}var u=function(){return Promise.all([a.e("common/vendor"),a.e("components/l-file/l-file")]).then(a.bind(null,"51e5"))},d=function(){return a.e("components/uni-ui/uni-segmented-control/uni-segmented-control").then(a.bind(null,"81a0"))},h=function(){return a.e("components/uni-ui/uni-popup/uni-popup").then(a.bind(null,"b037"))},f=function(){return a.e("components/uni-ui/uni-list/uni-list").then(a.bind(null,"6d22"))},p=function(){return a.e("components/uni-ui/uni-list-item/uni-list-item").then(a.bind(null,"1967"))},m=t.createInnerAudioContext(),y={components:{uniPopup:h,uniSegmentedControl:d,uniList:f,uniListItem:p,lFile:u},data:function(){return{account:"",token:"",current:0,items:["当前列表","收藏列表"],musicSrc:"",nowmiao:0,lrctime:0,allmiao:0,lineBarWid:520,playState:0,audioCont:"",audioList:[],lrcindex:0,type:"disk",tralrcindex:0,alldata:[],lrcdata:[],loveList:[],tralrcdata:[],audioPlaySrc:null,audioWay:0,collect:0}},computed:{playList:function(){return"disk"==this.type?this.audioList:"love"==this.type?this.loveList:void 0},width:function(){return"width:"+this.nowmiao/this.allmiao*this.lineBarWid+"upx"},playWidth:function(){return"transform:translate3d("+this.nowmiao/this.allmiao*this.lineBarWid+"upx,0,0);"},nowmiaoForc:function(){return this.$pubFuc.secondFormact(this.nowmiao)},allmiaoForc:function(){return this.$pubFuc.secondFormact(this.allmiao)},bgStyle:function(){return"disk"==this.type?0!=this.audioList.length&&this.audioPlaySrc<this.audioList.length&&this.audioList[this.audioPlaySrc].img||"../../static/img/music.png":"love"==this.type?0!=this.loveList.length&&this.audioPlaySrc<this.loveList.length&&this.loveList[this.audioPlaySrc].img||"../../static/img/music.png":void 0},LrcShow:function(){return this.lrcdata.length>0?this.lrcindex<=this.lrcdata.length&&0!=this.lrcindex?this.lrcdata[this.lrcindex-1].c:"......":"暂无歌词"},traLrcShow:function(){return this.tralrcdata.length>0&&this.tralrcindex<=this.tralrcdata.length&&0!=this.tralrcindex?this.tralrcdata[this.tralrcindex-1].c:""}},watch:{audioPlaySrc:{handler:function(t,i){var a=this;this.playList[t].id&&(this.lrcdata=[],this.lrcindex=0,this.tralrcdata=[],this.tralrcindex=0,this.collect=0,e.default.getMusicLrc(this.playList[this.audioPlaySrc].id).then(function(t){var i=o(t,2),n=(i[0],i[1]);a.lrcdata=e.default.createLrcObj(n.data.lrc.lyric),n.data.tlyric.lyric&&(a.tralrcdata=e.default.createLrcObj(n.data.tlyric.lyric))}))},deep:!0,immediate:!0}},onLoad:function(i){var a=this,n=getApp();this.account=n.globalData.account,this.token=n.globalData.token,this.audioList=[],null==m&&(m=t.createInnerAudioContext()),"pubdoc"==i.type&&(this.alldata=this.$store.state.filedata.music,this.musicSrc="http://39.106.78.21/PublicDoc/"),"prvdoc"==i.type&&(this.alldata=this.$store.state.prvdisk.music,this.musicSrc="http://39.106.78.21/PraviteDoc/"+i.disk+"/");var s={},l=this,r={keywords:e.default.getMusicName(i.item),limit:9};this.getLoveList(),e.default.getMusicId(r).then(function(t){var i=o(t,2),a=(i[0],i[1]),n={},l=e.default.CheckName(a.data.result.songs,r.keywords);if(l)return n.ids=l,s.id=l,e.default.MusicPic(n);n.ids=a.data.result.songs[0].id}).then(function(t){var n=o(t,2),l=(n[0],n[1]);if(s.img=l.data.songs[0].al.picUrl+"?param=600y600",s.author=l.data.songs[0].ar[0].name,s.name=l.data.songs[0].name,s.id)return e.default.CheckMusic(s.id);s.src=a.musicSrc+i.item}).then(function(t){var n=o(t,2),e=(n[0],n[1]);e.data.success?s.src="https://music.163.com/song/media/outer/url?id="+s.id+".mp3":s.src=a.musicSrc+i.item,l.audioList.push(s),l.audioPlaySrc=0,l.audioInit(),l.getPlayList(i.item)}).catch(function(t){s.src=a.musicSrc+i.item,s.img=null,s.author="",s.name=i.item,l.audioList.push(s),l.audioPlaySrc=0,l.audioInit(),l.getPlayList(i.item)})},onReady:function(){var t=this;plus.io.resolveLocalFileSystemURL("/storage/emulated/0/",function(t){t.getDirectory("Ishare",{create:!0,exclusive:!1},function(t){},function(){})},function(t){console.log(n("Resolve file URL failed: "+t.message," at pages\\info\\index.vue:316"))}),m.onPlay(function(){t.allmiao=Math.floor(m.duration),t.playFunc()}),m.onPause(function(){t.pauseFunc()}),m.onTimeUpdate(function(i){var a=m.currentTime;t.nowmiao=Math.floor(a),t.lrctime=a,t.lrcindex==t.lrcdata.length&&0!=t.lrcdata.length&&(t.lrcindex=t.lrcdata.length-1),t.lrcdata.length>0&&t.lrcindex<t.lrcdata.length&&parseFloat(t.lrcdata[t.lrcindex].t)<=a&&t.lrcdata.length-1!=t.lrcindex&&t.lrcindex++,t.tralrcindex==t.tralrcdata.length&&0!=t.tralrcdata.length&&(t.tralrcindex=t.tralrcdata.length-1),t.tralrcdata.length>0&&t.tralrcindex<t.tralrcdata.length&&parseFloat(t.tralrcdata[t.tralrcindex].t)<=a&&t.tralrcdata.length-1!=t.tralrcindex&&t.tralrcindex++}),m.onEnded(function(){t.lrctime=0,t.lrcdata=[],t.lrcindex=0,t.nextPlay()})},methods:{downLoad:function(){var t=this,i=this.playList[this.audioPlaySrc].src;this.$refs.lFile.download(i).then(function(i){var a=i.split(".").pop(),n="";n=t.playList[t.audioPlaySrc].author?t.playList[t.audioPlaySrc].name+"-"+t.playList[t.audioPlaySrc].author+"."+a:t.playList[t.audioPlaySrc].name+"."+a,plus.io.resolveLocalFileSystemURL("/storage/emulated/0/Ishare/",function(t){plus.io.resolveLocalFileSystemURL(i,function(i){i.moveTo(t,n,function(t){plus.nativeUI.toast("文件下载成功："+t.fullPath)},function(t){plus.nativeUI.toast("已有该文件")})},function(t){plus.nativeUI.toast("文件保存异常！")})},function(t){plus.nativeUI.toast("目录打开异常！")})})},onClickItem:function(t){this.current!==t&&(this.current=t)},openList:function(){this.$refs.musicList.open()},getPlayList:function(t){this.alldata.indexOf(t);for(var i=this.alldata,a=0;a<i.length;a++)i[a]!=t&&this.getItem(i[a])},getItem:function(t){var i=this,a={},n=this,s={keywords:e.default.getMusicName(t),limit:10};e.default.getMusicId(s).then(function(t){var i=o(t,2),n=(i[0],i[1]),l={},r=e.default.CheckName(n.data.result.songs,s.keywords);if(r)return l.ids=r,a.id=r,e.default.MusicPic(l);l.ids=n.data.result.songs[0].id}).then(function(n){var s=o(n,2),l=(s[0],s[1]);if(a.img=l.data.songs[0].al.picUrl+"?param=600y600",a.author=l.data.songs[0].ar[0].name,a.name=l.data.songs[0].name,a.id)return e.default.CheckMusic(a.id);a.src=i.musicSrc+t}).then(function(e){var s=o(e,2),l=(s[0],s[1]);l.data.success?a.src="https://music.163.com/song/media/outer/url?id="+a.id+".mp3":a.src=i.musicSrc+t,n.audioList.push(a)}).catch(function(e){a.src=i.musicSrc+t,a.img=null,a.author="",a.name=t,n.audioList.push(a)})},audioInit:function(){var i=this,a=this.playList[this.audioPlaySrc].src;null==m&&(m=t.createInnerAudioContext()),m.paused||m.stop(),m.src=a,m.play();var n={token:this.token,type:"getstatus",songid:this.playList[this.audioPlaySrc].id};e.default.SongsCollect(n).then(function(t){var a=o(t,2),n=(a[0],a[1]);"success"==n.data.type?i.collect=1:i.collect=0})},audiojump:function(t,i){i!=this.type?(m.paused||m.pause(),t!=this.audioPlaySrc&&(this.lrcdata=[],this.lrcindex=0,this.nowmiao=0,this.audioPlaySrc=t),this.type=i,this.audioInit()):t!=this.audioPlaySrc&&(this.lrcdata=[],this.lrcindex=0,this.nowmiao=0,this.audioPlaySrc=t,this.audioInit())},playFunc:function(){this.playState=1},pauseFunc:function(){this.playState=0},sliderChange:function(t){this.nowmiao=t.detail.value;for(var i=0;i<this.lrcdata.length;i++)if(this.lrcdata[i].t>=this.nowmiao){this.lrcindex=i;break}for(var a=0;a<this.tralrcdata.length;a++)if(this.tralrcdata[a].t>=this.nowmiao){this.tralrcindex=a;break}m.seek(this.nowmiao)},play:function(){0==this.playState?m.play():m.pause()},nextPlay:function(){1==this.audioWay?this.audioPlaySrc=Math.floor(10*Math.random())%this.playList.length:0==this.audioWay&&(this.audioPlaySrc>=this.playList.length-1?this.audioPlaySrc=0:this.audioPlaySrc=this.audioPlaySrc+1),this.lrcdata=[],this.lrcindex=0,this.nowmiao=0,this.audioInit()},getLoveList:function(){var t=this,i={token:this.token,type:"get"};e.default.SongsCollect(i).then(function(i){var a=o(i,2),n=(a[0],a[1]);"success"==n.data.type?t.loveList=n.data.data:plus.nativeUI.toast(n.data.data)}).catch(function(t){console.log(n(t," at pages\\info\\index.vue:595"))})},upPlay:function(){1==this.audioWay?this.audioPlaySrc=Math.floor(10*Math.random())%this.playList.length:0==this.audioWay&&(this.audioPlaySrc<1?this.audioPlaySrc=this.playList.length-1:this.audioPlaySrc=this.audioPlaySrc-1),this.lrcdata=[],this.lrcindex=0,this.nowmiao=0,this.audioInit()},audioWayFunc:function(){this.audioWay>1?this.audioWay=0:this.audioWay=this.audioWay+1},collectFunc:function(){var t=this;if(0==this.collect){var i=this.playList[this.audioPlaySrc];if(!i.id)return void plus.nativeUI.toast("暂不支持非网易云音乐资源收藏");var a=JSON.stringify(i),n={token:this.token,type:"add",songs:a};e.default.SongsCollect(n).then(function(a){var n=o(a,2),e=(n[0],n[1]);"success"==e.data.type?(t.collect=1,"收藏成功"==e.data.data&&-1==t.loveList.indexOf(i)&&t.loveList.push(i)):plus.nativeUI.toast(e.data.data)})}else if(1==this.collect){var s=this.playList[this.audioPlaySrc],l={token:this.token,type:"delete",songid:s.id};e.default.SongsCollect(l).then(function(i){var a=o(i,2),n=(a[0],a[1]);plus.nativeUI.toast(n.data.data),"success"==n.data.type&&(t.collect=0)})}}},destroyed:function(){m.destroy(),m=null,this.lrctime=0,this.lrcdata=[],this.lrcindex=0}};i.default=y}).call(this,a("6e42")["default"],a("0de9")["default"])},6089:function(t,i,a){"use strict";var n=function(){var t=this,i=t.$createElement;t._self._c},e=[];a.d(i,"a",function(){return n}),a.d(i,"b",function(){return e})},"7c4b":function(t,i,a){},"8d52":function(t,i,a){"use strict";a.r(i);var n=a("5fa7"),e=a.n(n);for(var s in n)"default"!==s&&function(t){a.d(i,t,function(){return n[t]})}(s);i["default"]=e.a},"9a03":function(t,i,a){"use strict";(function(t){a("4fad"),a("921b");n(a("66fd"));var i=n(a("ef2b"));function n(t){return t&&t.__esModule?t:{default:t}}t(i.default)}).call(this,a("6e42")["createPage"])},a5c0:function(t,i,a){"use strict";var n=a("7c4b"),e=a.n(n);e.a},ef2b:function(t,i,a){"use strict";a.r(i);var n=a("6089"),e=a("8d52");for(var s in e)"default"!==s&&function(t){a.d(i,t,function(){return e[t]})}(s);a("a5c0");var o=a("2877"),l=Object(o["a"])(e["default"],n["a"],n["b"],!1,null,"19ff4d78",null);i["default"]=l.exports}},[["9a03","common/runtime","common/vendor"]]]);