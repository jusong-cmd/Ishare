(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/login/login"],{2825:function(t,n,e){"use strict";e.r(n);var o=e("507f"),a=e.n(o);for(var i in o)"default"!==i&&function(t){e.d(n,t,function(){return o[t]})}(i);n["default"]=a.a},"507f":function(t,n,e){"use strict";(function(t,o){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=l(e("bd16")),i=l(e("814b")),u=e("b950"),s=e("2f62"),c=l(e("1399")),r=l(e("287f"));l(e("90d0"));function l(t){return t&&t.__esModule?t:{default:t}}function d(t,n){return g(t)||p(t,n)||f()}function f(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function p(t,n){var e=[],o=!0,a=!1,i=void 0;try{for(var u,s=t[Symbol.iterator]();!(o=(u=s.next()).done);o=!0)if(e.push(u.value),n&&e.length===n)break}catch(c){a=!0,i=c}finally{try{o||null==s["return"]||s["return"]()}finally{if(a)throw i}}return e}function g(t){if(Array.isArray(t))return t}function h(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{},o=Object.keys(e);"function"===typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(e).filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.forEach(function(n){b(t,n,e[n])})}return t}function b(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}var v=function(){return e.e("components/m-input").then(e.bind(null,"41ec"))},m={components:{mInput:v},data:function(){return{indexBackgroundImage:c.default,appIcon:r.default,imgsrc:i.default.apploginimage,providerList:[],hasProvider:!1,account:"",accountold:"",password:"",positionTop:0,KeepPw:!0,LoginAuto:!1,logintype:"phone",openid:""}},computed:(0,s.mapState)(["forcedLogin"]),watch:{account:function(t,n){t!=a.default.getUsers().account?this.password="":this.password=a.default.getUsers().password},logintype:function(n,e){"phone"!=n&&"qq"==n&&(this.account="",this.QQLogin(),t.showLoading({title:"QQ登录中...",mask:!0}))},LoginAuto:function(t,n){if(t&&a.default.getUsers().loginauto){var e=this;"phone"==this.logintype&&setTimeout(function(){e.bindLogin()},1e3)}}},methods:h({},(0,s.mapMutations)(["login"]),{qqLogin:function(){t.showLoading({title:"QQ授权中...",mask:!0}),t.login({provider:"qq",success:function(n){console.log(o(n," at pages\\login\\login.vue:108")),(0,u.SendQQInfo)({openid:n.authResult.openid,asskey:n.authResult.access_token,pfkey:n.authResult.pfkey}).then(function(e){var o=d(e,2),i=(o[0],o[1]),u=i.data.data;"error"==i.data.type?plus.nativeUI.toast(u):"success"==i.data.type&&(getApp().globalData.token=i.data.token,getApp().globalData.userid=i.data.userid,getApp().globalData.account=n.authResult.openid,a.default.addUser({type:"qq",loginauto:!0,account:n.authResult.openid}),a.default.addToken({account:n.authResult.openid,token:i.data.token}),t.hideLoading(),t.switchTab({url:"../main/main",animationType:"pop-in",animationDuration:200}))}).catch(function(n){plus.nativeUI.toast("服务器异常"),t.hideLoading()})},fail:function(n){t.hideLoading(),plus.nativeUI.toast("授权失败")}})},checkboxChange:function(t){this.KeepPw=!1,this.LoginAuto=!1;for(var n=t.detail.value,e=0;e<n.length;e++)"keeppw"==n[e]&&(this.KeepPw=!0),"loginauto"==n[e]&&(this.LoginAuto=!0)},bindLogin:function(){var n=this;if(this.account!=this.accountold&&(a.default.deletFinger(),a.default.deletUser()),this.account.length<5)plus.nativeUI.toast("账号最短为 5 个字符");else if(this.password.length<6)plus.nativeUI.toast("密码最短为 6 个字符");else{var e={account:this.account,password:this.password,id:this.account,loginauto:!1};t.showLoading({title:"登录验证中"}),t.request({url:i.default.login,method:"POST",data:e,header:i.default.header,success:function(o){var i=o.data;if("登录成功"==(0,u.checklogin)(i.type)){n.KeepPw&&(n.LoginAuto?(e.loginauto=!0,a.default.addUser(e)):a.default.addUser(e)),getApp().globalData.token=i.token,getApp().globalData.userid=i.userid,getApp().globalData.account=n.account,a.default.addToken({account:e.account,token:i.token}),t.hideLoading();getApp().globalData;t.showLoading({mask:!0,title:" "}),t.switchTab({url:"../main/main",animationType:"pop-in",animationDuration:200})}t.hideLoading()},fail:function(n){"request:fail abort"==n.errMsg&&plus.nativeUI.toast("服务器连接出错"),t.hideLoading()}})}},QQLogin:function(){var n=this,e={account:this.openid,openid:this.openid,type:"qq",loginauto:!0};t.request({url:i.default.QQlogin,method:"POST",data:e,header:i.default.header,success:function(o){var i=o.data;"success"==i.type?(getApp().globalData.token=i.token,getApp().globalData.userid=i.userid,getApp().globalData.account=n.openid,a.default.addToken({account:e.openid,token:i.token}),t.switchTab({url:"../main/main",animationType:"pop-in",animationDuration:200})):(a.default.deletFinger(),a.default.deletUser(),plus.nativeUI.toast(i.data)),t.hideLoading()},fail:function(n){plus.nativeUI.toast("服务器连接出错"),t.hideLoading()}})},initPosition:function(){this.positionTop=.6*t.getSystemInfoSync().windowWidth*.19}}),onReady:function(){this.initPosition()},onShow:function(){},onLoad:function(){var t=a.default.getUsers();console.log(o(t," at pages\\login\\login.vue:277")),this.logintype=t.type,this.accountold=t.account||"",this.openid=t.account||"",this.account=t.account||"",this.password=t.password||"",this.LoginAuto=t.loginauto||!1}};n.default=m}).call(this,e("6e42")["default"],e("0de9")["default"])},"680b":function(t,n,e){"use strict";(function(t){e("4fad"),e("921b");o(e("66fd"));var n=o(e("ef65"));function o(t){return t&&t.__esModule?t:{default:t}}t(n.default)}).call(this,e("6e42")["createPage"])},"68fc":function(t,n,e){"use strict";var o=e("9866"),a=e.n(o);a.a},9866:function(t,n,e){},ef65:function(t,n,e){"use strict";e.r(n);var o=e("f744"),a=e("2825");for(var i in a)"default"!==i&&function(t){e.d(n,t,function(){return a[t]})}(i);e("68fc");var u=e("2877"),s=Object(u["a"])(a["default"],o["a"],o["b"],!1,null,"6d341df7",null);n["default"]=s.exports},f744:function(t,n,e){"use strict";var o=function(){var t=this,n=t.$createElement;t._self._c},a=[];e.d(n,"a",function(){return o}),e.d(n,"b",function(){return a})}},[["680b","common/runtime","common/vendor"]]]);